%h3
  = "Create a new problem for Lesson: #{@problem_type.lesson.title}"

= form_for(@problem_type) do |t|
  = hidden_field_tag "problem_type[lesson_id]", @problem_type.lesson.id

  = t.label :title, "Title"
  = t.text_field :title
  %br

  = t.label :instruction_id, "Instruction"
  = t.select(:instruction_id, instruction_choices)
  %br
  = link_to "None of these will do... make new instructions", new_lesson_instruction_path(@problem_type.lesson)
  %br

  = t.fields_for :problem_levels do |level_builder|
    .row
      = level_builder.label :level_number
      %br
      = level_builder.text_field :level_number
  
    = render(:partial => "math_problems/nested_problem_form", :locals => {:builder => level_builder})

  .actions
    = t.submit
  
